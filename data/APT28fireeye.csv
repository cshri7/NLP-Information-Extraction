,text,url,query
0,"FireEye has moderate confidence that a campaign targeting the hospitality sector is attributed to Russian actor APT28 . We believe this activity, which dates back to at least July 2017, was intended to target travelers to hotels throughout Europe and the Middle East. The actor has used several notable techniques in these incidents such as sniffing passwords from Wi-Fi traffic, poisoning the NetBIOS Name Service, and spreading laterally via the EternalBlue exploit.  APT28 Uses Malicious Document to Target Hospitality Industry  FireEye has uncovered a malicious document sent in spear phishing emails to multiple companies in the hospitality industry, including hotels in at least seven European countries and one Middle Eastern country in early July. Successful execution of the macro within the malicious document results in the installation of APT28’s signature GAMEFISH malware.  The malicious document – Hotel_Reservation_Form.doc (MD5: 9b10685b774a783eabfecdb6119a8aa3), as seen in Figure 1 – contains a macro that base64 decodes a dropper that then deploys APT28’s signature GAMEFISH malware (MD5: 1421419d1be31f1f9ea60e8ed87277db), which uses mvband.net and mvtband.net as command and control (C2) domains.   Figure 1: Hotel_Reservation_Form.doc (MD5: 9b10685b774a783eabfecdb6119a8aa3)  APT28 Uses Novel Techniques to Move Laterally and Potentially Target Travelers  APT28 is using novel techniques involving the EternalBlue exploit and the open source tool Responder to spread laterally through networks and likely target travelers. Once inside the network of a hospitality company, APT28 sought out machines that controlled both guest and internal Wi-Fi networks. No guest credentials were observed being stolen at the compromised hotels; however, in a separate incident that occurred in Fall 2016, APT28 gained initial access to a victim’s network via credentials likely stolen from a hotel Wi-Fi network.  Upon gaining access to the machines connected to corporate and guest Wi-Fi networks, APT28 deployed Responder. Responder facilitates NetBIOS Name Service (NBT-NS) poisoning. This technique listens for NBT-NS (UDP/137) broadcasts from victim computers attempting to connect to network resources. Once received, Responder masquerades as the sought-out resource and causes the victim computer to send the username and hashed password to the attacker-controlled machine. APT28 used this technique to steal usernames and hashed passwords that allowed escalation of privileges in the victim network.  To spread through the hospitality company’s network, APT28 used a version of the EternalBlue SMB exploit. This was combined with the heavy use of py2exe to compile Python scripts. This is the first time we have seen APT28 incorporate this exploit into their intrusions.  In the 2016 incident, the victim was compromised after connecting to a hotel Wi-Fi network. Twelve hours after the victim initially connected to the publicly available Wi-Fi network, APT28 logged into the machine with stolen credentials. These 12 hours could have been used to crack a hashed password offline. After successfully accessing the machine, the attacker deployed tools on the machine, spread laterally through the victim's network, and accessed the victim's OWA account. The login originated from a computer on the same subnet, indicating that the attacker machine was physically close to the victim and on the same Wi-Fi network.  We cannot confirm how the initial credentials were stolen in the 2016 incident; however, later in the intrusion, Responder was deployed. Since this tool allows an attacker to sniff passwords from network traffic, it could have been used on the hotel Wi-Fi network to obtain a user’s credentials.  Long-Standing Threats to Travelers  Cyber espionage activity against the hospitality industry is typically focused on collecting information on or from hotel guests of interest rather than on the hotel industry itself, though actors may also collect information on the hotel as a means of facilitating operations. Business and government personnel who are traveling, especially in a foreign country, often rely on systems to conduct business other than those at their home office, and may be unfamiliar with threats posed while abroad.  APT28 isn’t the only group targeting travelers. South Korea-nexus Fallout Team (aka Darkhotel) has used spoofed software updates on infected Wi-Fi networks in Asian hotels , and Duqu 2.0 malware has been found on the networks of European hotels used by participants in the Iranian nuclear negotiations. Additionally, open sources have reported for several years that in Russia and China, high-profile hotel guests may expect their hotel rooms to be accessed and their laptops and other electronic devices accessed .  Outlook and Implications  These incidents show a novel infection vector being used by APT28. The group is leveraging less secure hotel Wi-Fi networks to steal credentials and a NetBIOS Name Service poisoning utility to escalate privileges. APT28’s already wide-ranging capabilities and tactics are continuing to grow and refine as the group expands its infection vectors.  Travelers must be aware of the threats posed when traveling – especially to foreign countries – and take extra precautions to secure their systems and data. Publicly accessible Wi-Fi networks present a significant threat and should be avoided whenever possible.  Additional technical information and details are available to FireEye iSIGHT Intelligence customers through our portal.",https://www.fireeye.com//blog/threat-research/2017/08/apt28-targets-hospitality-sector.html,APT28
1,"On Jan. 6, 2017, the U.S. Director of National Intelligence released its Intelligence Community Assessment: Assessing Russian Activities and Intentions in Recent US Elections. Still, questions persist about Russian involvement. Did the Russian government direct the group responsible for the breaches and related data leaks? If so, is this simply a matter of accepted state espionage, or did it cross a line? Was the breach at the Democratic National Committee part of a concerted effort by the Russian government to interfere with the U.S. presidential election?  The most consequential question remains unasked: How will Russia continue to employ a variety of methods – including hacks and leaks – to undermine the institutions, policies and actors that the Russian government perceives as constricting and condemning its forceful pursuit of its state aims?  FireEye’s visibility into the operations of APT28 – a group we believe the Russian government sponsors – has given us insight into some of the government’s targets, as well as its objectives and the activities designed to further them.  We have tracked and profiled this group through multiple investigations, endpoint and network detections, and continuous monitoring. Our visibility into APT28’s operations, which date to at least 2007, has allowed us to understand the group’s malware, operational changes and motivations. This intelligence has been critical to protecting and informing our clients, exposing this threat and strengthening our confidence in attributing APT28 to the Russian government.  Our latest report, APT28: At the Center of the Storm , is available here .  You can also register for our webinar on Feb. 21, 2017, at 8 a.m. PT/11 a.m. ET/4 p.m. GMT (UK), which will feature additional insights from Jonathan Wrolstad, Senior Threat Intelligence Analyst with FireEye, and Robert Morgus, Policy Analyst with New America’s Cybersecurity Initiative.",https://www.fireeye.com//blog/threat-research/2017/01/apt28_at_the_center.html,APT28
2,"Complimentary Intel
Report: Russia’s APT28 Strategically Evolves its Cyber Operations    Concerns over Russian espionage litter
today’s headlines as regional threat actors influence high-profile
international matters, including the 2016 U.S. presidential election
and more.  The U.S. Federal government confirmed
what FireEye long upheld – that the Russian actor group APT28 is
indeed sponsored by the Russian government – and in response, recently
released indicators of compromise (IoCs) to block their espionage
activities. Learn more about this advanced persistent threat. Having
tracked APT28 through multiple attacks and intrusions, FireEye has a
unique understanding of the group’s motives and techniques, tactics
and procedures (TTPs).  Download this free 15-page intelligence
report – At the Center of the Storm: Russia’s APT28 Strategically
Evolves its Cyber Operations – for our unique insight into:   APT28’s decade-long cyber support
of Russian strategic interests.  The techniques, tactics and
procedures (TTPs) employed to compromise their victims.  FireEye’s forensic and adversary intelligence gathered from
previous APT28 breaches.  APT28’s influence on numerous
high-profile national and international matters, including the
Syrian conflict, NATO-Ukraine relations and the 2016 U.S.
presidential election.   Gain valuable insight into who you’re
blocking and why. Download our summarized intel on this high-profile
Russian threat. Download this complimentary report today.",https://www.fireeye.com//current-threats/apt-groups/rpt-apt28.html,APT28
3,"The role of nation-state actors in cyber attacks was perhaps most widely revealed in February 2013 when Mandiant released the APT1 report, which detailed a professional cyber espionage group based in China. Today we release a new report: APT28: A Window Into Russia’s Cyber Espionage Operations?  This report focuses on a threat group that we have designated as APT28. While APT28’s malware is fairly well known in the cybersecurity community, our report details additional information exposing ongoing, focused operations that we believe indicate a government sponsor based in Moscow.  In contrast with the China-based threat actors that FireEye tracks, APT28 does not appear to conduct widespread intellectual property theft for economic gain. Instead, APT28 focuses on collecting intelligence that would be most useful to a government. Specifically, FireEye found that since at least 2007, APT28 has been targeting privileged information related to governments, militaries and security organizations that would likely benefit the Russian government.  In our report, we also describe several malware samples containing details that indicate that the developers are Russian language speakers operating during business hours that are consistent with the time zone of Russia’s major cities, including Moscow and St. Petersburg. FireEye analysts also found that APT28 has systematically evolved its malware since 2007, using flexible and lasting platforms indicative of plans for long-term use and sophisticated coding practices that suggest an interest in complicating reverse engineering efforts.  We assess that APT28 is most likely sponsored by the Russian government based on numerous factors summarized below:   FireEye is also releasing indicators to help organizations detect APT28 activity. Those indicators can be downloaded at https://github.com/fireeye/iocs .  As with the APT1 report, we recognize that no single entity completely understands the entire complex picture of intense cyber espionage over many years. Our goal by releasing this report is to offer an assessment that informs and educates the community about attacks originating from Russia. The complete report can be downloaded here: /content/dam/legacy/resources/pdfs/apt28.pdf .",https://www.fireeye.com//blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html,APT28
4,"FireEye Labs recently detected a limited APT campaign exploiting zero-day vulnerabilities in Adobe Flash and a brand-new one in Microsoft Windows. Using the Dynamic Threat Intelligence Cloud (DTI), FireEye researchers detected a pattern of attacks beginning on April 13 th , 2015. Adobe independently patched the vulnerability (CVE-2015-3043) in APSB15-06 . Through correlation of technical indicators and command and control infrastructure, FireEye assess that APT28 is probably responsible for this activity.  Microsoft is aware of the outstanding local privilege escalation vulnerability in Windows (CVE-2015-1701). While there is not yet a patch available for the Windows vulnerability, updating Adobe Flash to the latest version will render this in-the-wild exploit innocuous. We have only seen CVE-2015-1701 in use in conjunction with the Adobe Flash exploit for CVE-2015-3043. The Microsoft Security Team is working on a fix for CVE-2015-1701.  Exploit Overview  The high level flow of the exploit is as follows:  1.       User clicks link to attacker controlled website 2.       HTML/JS launcher page serves Flash exploit 3.       Flash exploit triggers CVE-2015-3043, executes shellcode 4.       Shellcode downloads and runs executable payload 5.       Executable payload exploits local privilege escalation (CVE-2015-1701) to steal System token  The Flash exploit is served from unobfuscated HTML/JS. The launcher page picks one of two Flash files to deliver depending upon the target’s platform (Windows 32 versus 64bits).  The Flash exploit is mostly unobfuscated with only some light variable name mangling. The attackers relied heavily on the CVE-2014-0515 Metasploit module, which is well documented. It is ROPless, and instead constructs a fake vtable for a FileReference object that is modified for each call to a Windows API.  The payload exploits a local privilege escalation vulnerability in the Windows kernel if it detects that it is running with limited privileges. It uses the vulnerability to run code from userspace in the context of the kernel, which modifies the attacker’s process token to have the same privileges as that of the System process.  CVE-2015-3043 Exploit  The primary difference between the CVE-2014-0515 metasploit module and this exploit is, obviously, the vulnerability. CVE-2014-0515 exploits a vulnerability in Flash’s Shader processing, whereas CVE-2015-3043 exploits a vulnerability in Flash’s FLV processing. The culprit FLV file is embedded within AS3 in two chunks, and is reassembled at runtime.  Vulnerability  A buffer overflow vulnerability exists in Adobe Flash Player (<=17.0.0.134) when parsing malformed FLV objects. Attackers exploiting the vulnerability can corrupt memory and gain remote code execution.  In the exploit, the attacker embeds the FLV object directly in the ActionScript code, and plays the video using NetStream class. In memory, it looks like the following:  0000000: 46 4c 56 01 05 00 00 00 09 00 00 00 00 12 00 00  FLV............. 0000010: f4 00 00 00 00 00 00 00 02 00 0a 6f 6e 4d 65 74  ...........onMet 0000020: 61 44 61 74 61 08 00 00 00 0b 00 08 64 75 72 61  aData.......dura 0000030: 74 69 6f 6e 00 40 47 ca 3d 70 a3 d7 0a 00 05 77  tion.@G.=p.....w 0000040: 69 64 74 68 00 40 74 00 00 00 00 00 00 00 06 68  idth.@t........h 0000050: 65 69 67 68 74 00 40 6e 00 00 00 00 00 00 00 0d  eight.@n........ 0000060: 76 69 64 65 6f 64 61 74 61 72 61 74 65 00 00 00  videodatarate... ….. 0003b20: 27 6e ee 72 87 1b 47 f7 41 a0 00 00 00 3a 1b 08  'n.r..G.A....:.. 0003b30: 00 04 41 00 00 0f 00 00 00 00 68 ee ee ee ee ee  ..A.......h..... 0003b40: ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee  ................ 0003b50: ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee  ................ 0003b60: ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee ee  ................   Files of the FLV file format contain a sequence of Tag structures. In Flash, these objects are created when parsing FLV Tags:  .text:1018ACE9 sub_1018ACE9    proc near               ; CODE XREF: sub_1018BBAC+2Bp .text:1018ACE9                                         ; sub_10192797+1A1p ... .text:1018ACE9 .text:1018ACE9 arg_0           = dword ptr  4 .text:1018ACE9 .text:1018ACE9                 mov     eax, ecx .text:1018ACEB                 mov     ecx, [esp+arg_0] .text:1018ACEF                 mov     dword ptr [eax], offset off_10BA771C .text:1018ACF5                 mov     dword ptr [eax+24h], 1 .text:1018ACFC                 and     dword ptr [eax+14h], 0 .text:1018AD00                 mov     [eax+28h], ecx .text:1018AD03                 mov     byte ptr [eax+20h], 0 .text:1018AD07                 retn    4 .text:1018AD07 sub_1018ACE9    endp   In the case of this exploit, a Tag structure begins at offset 0x3b2f into the FLV stream that, when parsed, populates the Tag structure as follows:  Tag 2: UINT_8 type: 8 UINT_24 datasize: 1089 UINT_24 timestamp: 15 UINT_8 timestamphi: 0 UINT_24 streamid: 0 UINT_4 fmt: 6 UINT_2 sr: 2 UINT_1 bits: 0 UINT_1 channels: 0 UBYTE data[1088]: \xee\xee\xee\xee… UINT_32 lastsize: 0xeeeeeeee   Beginning within the data field, all contents of the FLV stream become 0xEE. Consequently, the data and lastsize fields are mangled, and one final tag technically exists consisting exclusively of 0xEE:  Tag 3: UINT_8 type: 0xEE UINT_24 datasize: 0xEEEEEE …   One can see the datasize field of Tag2 populated from the attacker's FLV stream below:  .text:10192943                 mov     eax, [ebx+24h] .text:10192946                 mov     [esi+14h], eax .text:10192949                 movzx   eax, byte ptr [ebx+19h] ; 00 .text:1019294D                 movzx   ecx, byte ptr [ebx+1Ah] ; 04 .text:10192951                 shl     eax, 8 .text:10192954                 or      eax, ecx .text:10192956                 movzx   ecx, byte ptr [ebx+1Bh] ; 41 .text:1019295A                 shl     eax, 8 .text:1019295D                 or      eax, ecx .text:1019295F                 mov     ecx, ebx .text:10192961                 mov     [esi+0Ch], eax  ; 0x441 .text:10192964                 call    sub_1002E2B3   The buffer is allocated with fixed size 0x2000:  .text:101A647E                 push    2000h .text:101A6483                 mov     ecx, esi .text:101A6485                 call    sub_101A6257    ; alloc 0x2000 buffer, store in esi+0xDC …… .text:101A627F                 push    0 .text:101A6281                 push    edi             ; 0x2000 .text:101A6282                 call    sub_105EBEB0 .text:101A6287                 pop     ecx .text:101A6288                 pop     ecx .text:101A6289                 mov     [esi+0DCh], eax  Since the size is controlled by the attacker, it’s possible to overflow the fixed size buffer with certain data.   A datasize of 0x441 results in a value here of 0x1100 passed to sub_100F88F8, which memcopies 0x2200 bytes in 0x11 chunks of 0x200. The last memcpy overflows the fixed size 0x2000 buffer into a adjacent heap memory.  Attackers spray the heap with array of Vector, 0x7fe * 4 + 8 == 0x2000, and create holes of such size, which will be allocated by the said object.  while (_local_2 < this._bp35) // _bp35 == 0x2000 { this._ok47[_local_2] = new Vector.<uint>(this._lb60); // _lb60 == 0x07FE _local_3 = 0x00; while (_local_3 < this._lb60) { this._ok47[_local_2][_local_3] = 0x41414141; _local_3++; }; _local_2 = (_local_2 + 0x01); }; _local_2 = 0x00; while (_local_2 < this._bp35) { this._ok47[_local_2] = null; _local_2 = (_local_2 + 0x02); };   As the previous picture demonstrated, the followed Vector object’s length field being overflowed as 0x80007fff, which enables the attacker to read/write arbitrary data within user space.  Shellcode  Shellcode is passed to the exploit from HTML in flashvars. The shellcode downloads the next stage payload, which is an executable passed in plaintext, to the temp directory with UrlDownloadToFileA, which it then runs with WinExec.  Payload & C2  This exploit delivers a malware variant that shares characteristics with the APT28 backdoors CHOPSTICK and CORESHELL malware families, both described in our APT28 whitepaper .  The malware uses an RC4 encryption key that was previously used by the CHOPSTICK backdoor.  And the C2 messages include a checksum algorithm that resembles those used in CHOPSTICK backdoor communications.  In addition, the network beacon traffic for the new malware resembles those used by the CORESHELL backdoor.  Like CORESHELL, one of the beacons includes a process listing from the victim host.  And like CORESHELL, the new malware attempts to download a second-stage executable.  One of the C2 locations for the new payload, 87.236.215[.]246 , also hosts a suspected APT28 domain ssl-icloud[.]com .  The same subnet ( 87.236.215.0/24 ) also hosts several known or suspected APT28 domains, as seen in Table 1.   The target firm is an international government entity in an industry vertical that aligns with known APT28 targeting.  CVE-2015-1701 Exploit  The payload contains an exploit for the unpatched local privilege escalation vulnerability CVE-2015-1701 in Microsoft Windows. The exploit uses CVE-2015-1701 to execute a callback in userspace. The callback gets the EPROCESS structures of the current process and the System process, and copies data from the System token into the token of the current process. Upon completion, the payload continues execution in usermode with the privileges of the System process.  Because CVE-2015-3043 is already patched, this remote exploit will not succeed on a fully patched system. If an attacker wanted to exploit CVE-2015-1701, they would first have to be executing code on the victim’s machine. Barring authorized access to the victim’s machine, the attacker would have to find some other means, such as crafting a new Flash exploit, to deliver a CVE-2015-1701 payload.  Microsoft is aware of CVE-2015-1701 and is working on a fix. CVE-2015-1701 does not affect Windows 8 and later.  Acknowledgements  Thank you to all of the contributors to this blog!   The following people in FireEye: Dan Caselden, Yasir Khalid, James “Tom” Bennett, GenWei Jiang, Corbin Souffrant, Joshua Homan, Jonathan Wrolstad, Chris Phillips, Darien Kindlund  Microsoft & Adobe security teams",https://www.fireeye.com//blog/threat-research/2015/04/probable_apt28_useo.html,APT28
